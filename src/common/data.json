{
  "metadata": {
    "title": "迷雾森林的秘密",
    "author": "Manus AI",
    "version": "1.1.0",
    "indexNode": "start"
  },
  "variables": {
    "player": {
      "name": "艾拉",
      "health": 100,
      "hasKey": false,
      "hasAmulet": false,
      "knowsSecret": false
    },
    "world": {
      "time": 480,
      "day": 1,
      "formattedTime": "08:00",
      "timePeriod": "早晨"
    },
    "show": {
      "player_health": {
        "desc": "生命值",
        "value": 100
      },
      "current_day": {
        "desc": "天数",
        "value": 1
      },
      "current_time": {
        "desc": "时间",
        "value": "08:00"
      }
    },
    "temp": {}
  },
  "nodes": {
    "start": {
      "title": "森林边缘",
      "text": "你好，{var.player.name}。你站在迷雾森林的边缘，现在是第 {var.world.day} 天的 {var.world.timePeriod} ({var.world.formattedTime})。一条小径通向森林深处。\n\n{0}",
      "links": [
        {
          "text": "踏上小径",
          "target": "forest_path"
        }
      ],
      "actions": [
        {
          "type": "addListener",
          "id": "low_health_warning",
          "condition": "var.player.health < 50",
          "actions": [
            {
              "type": "toast",
              "message": "你感到非常虚弱！"
            }
          ],
          "once": false
        },
        {
          "type": "addListener",
          "id": "update_sidebar",
          "condition": "true",
          "actions": [
            {
              "type": "set",
              "target": "var.show.player_health.value",
              "value": "$(var.player.health)"
            },
            {
              "type": "set",
              "target": "var.show.current_day.value",
              "value": "$(var.world.day)"
            },
            {
              "type": "set",
              "target": "var.show.current_time.value",
              "value": "$(var.world.formattedTime)"
            }
          ],
          "once": false
        }
      ]
    },
    "forest_path": {
      "title": "森林小径",
      "text": "你沿着小径走了10分钟。{cond.path_description}\n\n你看到前方有一个岔路口。{0} {1}，或者继续 {2}。",
      "links": [
        {
          "text": "走向左边的古树",
          "target": "ancient_tree"
        },
        {
          "text": "走向右边的石碑",
          "target": "stone_tablet"
        },
        {
          "text": "沿着小径继续深入",
          "target": "guardian_statue"
        }
      ],
      "actions": [
        {
          "type": "advanceTime",
          "minutes": 10
        }
      ],
      "conds": {
        "path_description": [
          {
            "condition": "var.world.timePeriod == '夜晚'",
            "text": "夜色已深，周围传来奇怪的声响。"
          },
          {
            "text": "阳光透过树叶，洒下斑驳的光影。"
          }
        ]
      }
    },
    "ancient_tree": {
      "title": "古树之下",
      "text": "你来到一棵巨大的古树下，树干上有一个小小的洞。{random.tree_hole_event}\n\n{0}",
      "links": [
        {
          "text": "回到岔路口",
          "target": "forest_path"
        }
      ],
      "randoms": {
        "tree_hole_event": [
          {
            "text": "你伸手进去，摸到了一个冰冷的护身符！",
            "weight": 30,
            "actions": [
              {
                "type": "set",
                "target": "var.player.hasAmulet",
                "value": true
              },
              {
                "type": "toast",
                "message": "你获得了【守护护身符】"
              }
            ]
          },
          {
            "text": "你伸手进去，结果被什么东西咬了一口！",
            "weight": 20,
            "actions": [
              {
                "type": "add",
                "target": "var.player.health",
                "value": -10
              },
              {
                "type": "vibrate",
                "mode": "short"
              }
            ]
          },
          {
            "text": "你伸手进去，里面空空如也。",
            "weight": 50
          }
        ]
      }
    },
    "stone_tablet": {
      "title": "神秘石碑",
      "text": "石碑上刻着古老的文字，大部分已经模糊不清，只有一行字还能辨认：\n“当守护者拥有钥匙，秘密将被揭示。”\n\n{0}",
      "links": [
        {
          "text": "回到岔路口",
          "target": "forest_path",
          "actions": [
            {
              "type": "set",
              "target": "var.player.knowsSecret",
              "value": true
            }
          ]
        }
      ]
    },
    "guardian_statue": {
      "title": "守护者雕像",
      "text": "在森林的尽头，你发现了一座手持空心圆盘的守护者雕像。{img.statue}\n\n{0}\n{1}",
      "links": [
        {
          "text": "将护身符放入圆盘",
          "target": "secret_revealed",
          "condition": "var.player.hasAmulet && var.player.knowsSecret",
          "actions": [
            {
              "type": "set",
              "target": "var.player.hasKey",
              "value": true
            },
            {
              "type": "toast",
              "message": "你获得了【古老的钥匙】"
            }
          ]
        },
        {
          "text": "回到岔路口",
          "target": "forest_path"
        }
      ],
      "imgs": {
        "statue": {
          "path": "guardian_statue.png",
          "width": 150
        }
      }
    },
    "secret_revealed": {
      "title": "秘密揭示",
      "text": "当你把护身符放入圆盘，雕像发出柔和的光芒，一枚古老的钥匙出现在你手中。看来森林的秘密，需要用这把钥匙去开启。\n\n你的冒险，才刚刚开始……",
      "actions": [
        {
          "type": "autosave"
        }
      ]
    }
  }
}
